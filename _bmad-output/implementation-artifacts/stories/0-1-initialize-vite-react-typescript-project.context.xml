<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>0</epicId>
    <storyId>1</storyId>
    <title>Initialize Vite + React + TypeScript Project</title>
    <status>drafted</status>
    <generatedAt>2025-11-04</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/stories/0-1-initialize-vite-react-typescript-project.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>developer</asA>
    <iWant>a Vite + React + TypeScript project initialized with the correct versions</iWant>
    <soThat>I have the foundational project structure to build upon</soThat>
    <tasks>
      - Initialize Vite project (AC: 1)
        - Run `npm create vite@latest claine-rebuild-v2 -- --template react-ts`
        - Verify successful project creation
        - Test: Run `npm install` successfully
      - Verify and upgrade framework versions (AC: 2, 3, 4)
        - Check Vite version is 7.0.x (package.json)
        - Upgrade React to 19.2.x: `npm install react@19.2 react-dom@19.2`
        - Upgrade TypeScript to 5.9.x: `npm install typescript@5.9 -D`
        - Test: Run `npm run build` successfully
      - Create project folder structure (AC: 5)
        - Create feature directories: email/, ai/, workflow/, auth/
        - Create shared directory with subdirectories
        - Create db/, workers/, routes/, tests/ directories
        - Test: Verify all directories exist
      - Configure TypeScript path aliases (AC: 5)
        - Update tsconfig.json with path aliases
        - Update vite.config.ts to resolve path aliases
        - Test: Import using alias path in App.tsx
      - Create basic App component (AC: 6)
        - Modify App.tsx to render "Claine v2" text
        - Remove default Vite boilerplate content
        - Test: App renders "Claine v2" successfully
      - Verify development server (AC: 7)
        - Run npm run dev
        - Open http://localhost:5173 in browser
        - Test: Server starts without errors and displays "Claine v2"
        - Test: Hot module replacement (HMR) works
    </tasks>
  </story>

  <acceptanceCriteria>
    1. Project created using `npm create vite@latest claine-rebuild-v2 -- --template react-ts`
    2. Vite version verified as 7.0.x (latest stable)
    3. React version upgraded to 19.2.x (as specified in architecture.md)
    4. TypeScript version set to 5.9.x (as specified in architecture.md)
    5. Project structure follows architecture.md folder organization:
       - `src/features/` (email/, ai/, workflow/, auth/)
       - `src/components/` (shared components)
       - `src/lib/` (utilities)
       - `src/db/` (database schemas)
       - `src/services/` (business logic)
    6. Basic App.tsx renders "Claine v2" successfully
    7. Development server runs: `npm run dev` opens http://localhost:5173
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>Starter Template Decision</section>
        <snippet>Vite + React + TypeScript template selected. Command: npm create vite@latest claine-rebuild-v2 -- --template react-ts. Requires Node.js 20.19+ or 22.12+ for Vite 7.0.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>Executive Summary - Key Decisions</section>
        <snippet>Framework: Vite 7.0, React 19.2, TypeScript 5.9. Vite 7 provides fastest builds (ESM-only). React 19.2 is latest stable with improved hooks. TypeScript 5.9 supports deferred imports.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>Project Structure - Folder Organization</section>
        <snippet>Feature-based organization with domains: email/, ai/, workflow/, auth/. Each feature contains: components/, hooks/, services/, store/, types/, utils/. Shared directory for cross-feature components. Database schemas in src/db/.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>Module Boundaries</section>
        <snippet>Rule 1: Features are self-contained, can import from shared/ but NOT from other features. Rule 2: Layer dependencies - Components → hooks → services → store → types/utils. Rule 3: ONLY services can access RxDB collections.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Decision Document</title>
        <section>Import Conventions</section>
        <snippet>TypeScript path aliases: @/*, @features/*, @shared/*, @db/*, @workers/*. Example: import { Button } from '@shared/components/Button'</snippet>
      </doc>
      <doc>
        <path>docs/epics/epic-0-infrastructure-project-setup.md</path>
        <title>Epic 0: Infrastructure & Project Setup</title>
        <section>Story 0.1 - Expanded Goal</section>
        <snippet>Establish complete project infrastructure before feature development. Creates technical foundation using validated architecture. Must complete before Epic 1 begins.</snippet>
      </doc>
    </docs>
    <code>
      <!-- No existing code - this is the initial project setup story -->
      <note>This is Story 0.1: Initial project creation. No existing code to reference.</note>
    </code>
    <dependencies>
      <node>
        <required>Node.js 20.19+ or 22.12+</required>
        <reason>Required for Vite 7.0</reason>
      </node>
      <npm>
        <core>
          <package name="vite" version="7.0.x" type="dev">Fast HMR, ESM-only builds</package>
          <package name="react" version="19.2.x">Latest stable with improved hooks API</package>
          <package name="react-dom" version="19.2.x">React DOM renderer</package>
          <package name="typescript" version="5.9.x" type="dev">Deferred imports support</package>
        </core>
        <future-stories>
          <note>These will be installed in later stories (0.2-0.10):</note>
          <package name="vite-plugin-pwa" type="dev">PWA support</package>
          <package name="tailwindcss" version="4.0.0" type="dev">Styling with Oxide engine</package>
          <package name="zustand" version="5.0.8">State management</package>
          <package name="rxdb" version="16.20.0">Offline-first database</package>
          <package name="vitest" version="4.0.x" type="dev">Unit testing (Story 0.4)</package>
          <package name="playwright" version="1.56.x" type="dev">E2E testing (Story 0.5)</package>
        </future-stories>
      </npm>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>Node.js 20.19+ or 22.12+ required for Vite 7.0</constraint>
    <constraint>Must use exact framework versions: Vite 7.0.x, React 19.2.x, TypeScript 5.9.x</constraint>
    <constraint>Feature isolation: Features can import from shared/ but NOT from other features</constraint>
    <constraint>Layer dependencies: Components → hooks → services → store → types/utils</constraint>
    <constraint>Database access: ONLY services can access RxDB collections</constraint>
    <constraint>TypeScript path aliases required: @/*, @features/*, @shared/*, @db/*, @workers/*</constraint>
    <constraint>Project structure must match architecture.md folder organization</constraint>
    <constraint>Must create all feature directories upfront (email/, ai/, workflow/, auth/) even if empty</constraint>
  </constraints>
  <interfaces>
    <!-- No interfaces to define yet - this is initial project setup -->
    <note>Initial setup story - no interfaces to implement. Future stories will define API contracts.</note>
  </interfaces>
  <tests>
    <standards>
      Testing framework for Story 0.1 is manual verification only. Automated testing infrastructure will be configured in later stories:
      - Story 0.4: Vitest 4.0 for unit tests (Vite-native, browser mode support)
      - Story 0.5: Playwright 1.56 for E2E tests (best PWA E2E testing, visual regression)
      Test locations: tests/unit/ for Vitest tests, tests/e2e/ for Playwright tests
    </standards>
    <locations>
      <location>tests/unit/</location>
      <location>tests/e2e/</location>
      <note>Test directories will be created in this story but test infrastructure configured in Stories 0.4 and 0.5</note>
    </locations>
    <ideas>
      <test id="AC-1" type="manual">
        <description>Verify project creation command executes successfully</description>
        <steps>Run: npm create vite@latest claine-rebuild-v2 -- --template react-ts. Verify no errors.</steps>
      </test>
      <test id="AC-2" type="manual">
        <description>Verify Vite version is 7.0.x</description>
        <steps>Check package.json for "vite": "^7.0.x"</steps>
      </test>
      <test id="AC-3" type="manual">
        <description>Verify React upgraded to 19.2.x</description>
        <steps>After upgrade: npm install react@19.2 react-dom@19.2. Check package.json.</steps>
      </test>
      <test id="AC-4" type="manual">
        <description>Verify TypeScript upgraded to 5.9.x</description>
        <steps>After upgrade: npm install typescript@5.9 -D. Check package.json.</steps>
      </test>
      <test id="AC-5" type="manual">
        <description>Verify all directories created per architecture.md</description>
        <steps>Run: ls -R src/. Verify: src/features/{email,ai,workflow,auth}/, src/shared/, src/db/, src/workers/, src/routes/, tests/{unit,e2e,fixtures}/</steps>
      </test>
      <test id="AC-5-paths" type="manual">
        <description>Verify TypeScript path aliases work</description>
        <steps>Add test import in App.tsx using @shared alias. Run: npm run dev. Verify no import errors.</steps>
      </test>
      <test id="AC-6" type="manual">
        <description>Verify App.tsx renders "Claine v2"</description>
        <steps>Run: npm run dev. Open http://localhost:5173. Verify "Claine v2" text displays.</steps>
      </test>
      <test id="AC-7" type="manual">
        <description>Verify development server starts without errors</description>
        <steps>Run: npm run dev. Verify server starts on port 5173 with no console errors.</steps>
      </test>
      <test id="AC-7-hmr" type="manual">
        <description>Verify Hot Module Replacement (HMR) works</description>
        <steps>With dev server running, change text in App.tsx. Verify browser auto-updates without full reload.</steps>
      </test>
      <test id="build" type="manual">
        <description>Verify production build succeeds</description>
        <steps>Run: npm run build. Verify build completes with no errors and creates dist/ directory.</steps>
      </test>
    </ideas>
  </tests>
</story-context>
